"use strict";var availableStock=0,isInitiaLize=!(""!=stockProductId);$("#vendor_id").on("change",function(){getVendorLocation($(this).val())}),$("#checkbox-p-2").on("click",function(){!0==$(this).prop("checked")&&1==isDisableMultivendor&&$("#vendor_id").trigger("change")}),$(".save-brand-info").on("click",function(){isInitiaLize&&"vendor.product.create"!=currentRouteName&&"vendor.product.edit"!=currentRouteName&&(getVendorLocation($("#vendor_id").val()),isInitiaLize=!1)}),checkInitialStockDiv(),checkVendorUserProduct();function checkVendorUserProduct(){"vendor.product.create"==currentRouteName&&(getVendorLocation(loginUserVendorId),isInitiaLize=!1)}function checkInitialStockDiv(){0<$(".initial_stock_div").length?$("#save_stock_div").removeClass("display_none"):""}function getVendorLocation(a){$.ajax({url:vendorLocationUrl,dataType:"json",type:"get",data:{vendor_id:a,product_id:stockProductId},success:function(a){let b=`<input type="hidden" id="temp_vendor_id" name="temp_vendor_id">`,c=1234;if($(".variation_stock_data").empty(),"1"==a.status)$("#stock_msg").text(a.message),b+=getAdjustStockHtml(a.data.stocks),$.each(a.data.locations,function(a,d){let e="col_"+c++;b+=`<div class="location-dlt ui-sortable-handle" data-serial="${a}">
                <form method="POST">
                <div class="d-flex justify-content-between align-items-center border-t h-40p mx-25n px-32p bg-F5 col-attr collapse-header"
                     data-bs-toggle="collapse" href="#${e}">
                    <p class="label-title m-0 ml-16n-res font-weight-600 attribute-box-title">${d.name}</p>
                    <div class="d-flex align-items-center">
                        <svg class="cursor-move mt-0" width="16" height="11" viewBox="0 0 16 11" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <rect width="16" height="1" fill="#898989" />
                            <rect y="5" width="16" height="1" fill="#898989" />
                            <rect y="10" width="16" height="1" fill="#898989" />
                        </svg>
                        <span
                            class="toggle-btn ml-10p mt-0 d-flex h-20 w-20 align-items-center justify-content-center inactive-sec collapsed"
                            data-bs-toggle="collapse" href="#${e}">
                            <svg width="8" height="6" viewBox="0 0 8 6" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M4.18767 5.90789L7.81732 1.34361C8.24162 0.810056 7.87956 -1.43628e-09 7.21678 -9.33983e-09L0.783223 -8.60592e-08C0.120445 -9.39628e-08 -0.241618 0.810055 0.182683 1.34361L3.81233 5.90789C3.91 6.0307 4.09 6.0307 4.18767 5.90789Z"
                                    fill="#2C2C2C" />
                            </svg>
                        </span>

                    </div>
                </div>
                <div class="collapse" id="${e}">
                    <div class="row m-0 px-7 pb-30p">

                            <div class="form-group row mt-3">
                                <label class="col-sm-6 control-label" for="inputEmail3">${jsLang("Available")}</label>
                                <input type="hidden" value="${d.id}" name="location[${d.id}][id]">
                                <div class="col-sm-6">
                                <input type="number" placeholder="${jsLang("Available")}" value="0" class="form-control adjust_by inputFieldDesign" name="location[${d.id}][qty]" required oninvalid="this.setCustomValidity('${jsLang("This field is required.")}')">
                                </div>
                            </div>
                       
                    </div>
                </div>
                </form>
            </div>`}),$.each(a.data.variations,function(a,b){let d=``;$(".empty_vendor").remove(),$.each(b.variations,function(b,e){let f="var_"+c++;d+=`
                       <tr draggable="false"
                           class="ui-sortable-handle variation_stock">
                           <td class="label">
                               <div class="d-flex align-items-center rtl:gap-2">
                                   <svg class="me-2" width="16" height="11" viewBox="0 0 16 11"
                                        fill="none" xmlns="http://www.w3.org/2000/svg">
                                       <rect width="16" height="1" fill="#898989">
                                       </rect>
                                       <rect y="5" width="16" height="1" fill="#898989">
                                       </rect>
                                       <rect y="10" width="16" height="1" fill="#898989">
                                       </rect>
                                   </svg>
                                   <input type="hidden" name="adjust[${a}][${e.id}][product_id]" value="${e.product_id}">
                                   <input type="hidden" name="adjust[${a}][${e.id}][location_id]" value="${e.location_id}">
                                   
                                   <label class="control-label">${e.location.name}</label>
                               </div>
                           </td>
                           <td>
                               <label class="control-label" id="available_stock_${f}">${parseInt(e.available)}</label>
                           </td>
                           <td>
                               <input type="number" placeholder="0" class="form-control inputFieldDesign adjust_by" maxlength="8" id="adjust_by_${f}" data-rowId="${f}" name="adjust[${a}][${e.id}][adjust_by]" value="0">
                           </td>
                           <td>
                               <input type="number" placeholder="0" class="form-control inputFieldDesign new_stock" maxlength="8" id="new_stock_${f}" data-rowId="${f}" name="adjust[${a}][${e.id}][new]" value="${parseInt(e.available)}">
                           </td>
                           <td>
                               <select class="form-control select2 sl_common_bx" name="adjust[${a}][${e.id}][new]" required oninvalid="this.setCustomValidity('${jsLang("This field is required.")}')">
                                   <option value="Correction">${jsLang("Correction")}</option>
                                    <option value="Count">${jsLang("Count")}</option>
                                    <option value="Received">${jsLang("Received")}</option>
                                    <option value="Return_restock">${jsLang("Return restock")}</option>
                                    <option value="Damaged">${jsLang("Damaged")}</option>
                                    <option value="Theft_or_loss">${jsLang("Theft or loss")}</option>
                                    <option value="Promotion_or_donation">${jsLang("Promotion or donation")}</option>
                               </select>
                           </td>
                       </tr>
                `}),$.each(b.locations,function(b,c){d+=`
                     <tr draggable="false"
                        class="ui-sortable-handle variation_stock">
                        <td class="label">
                            <div class="d-flex align-items-center rtl:gap-2">
                                <svg class="me-2" width="16" height="11" viewBox="0 0 16 11"
                                     fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="16" height="1" fill="#898989">
                                    </rect>
                                    <rect y="5" width="16" height="1" fill="#898989">
                                    </rect>
                                    <rect y="10" width="16" height="1" fill="#898989">
                                    </rect>
                                </svg>
                                <label class="control-label">${c.name}</label>
                                <input type="hidden" name="location[${a}][${c.id}][id]" value="${c.id}">
                            </div>
                        </td>
                        <td>
                            <input type="number" placeholder="0" class="form-control inputFieldDesign" maxlength="8" name="location[${a}][${c.id}][qty]" value="0">
                        </td>
                    </tr>
                    `}),$("#variation_stock_data_"+b.variation_id).append(d)}),"1"!=a.data.isInitialize||isInitiaLize?"1"==a.data.isInitialize&&isInitiaLize&&$(".variation_stock_data").each(function(){let a=`<tr draggable="false" class="ui-sortable-handle empty_vendor">
                            <td colspan="3">${jsLang("Please select & save vendor before save variations.")}</td>
                        </tr>`;$(this).append(a)}):$(".variation_stock_data").each(function(b){let c=``;c=getRawVariationLocation(a.data.locations,b),$(this).append(c)});else{$("#stock_msg").text(a.message);let b=`<tr draggable="false" class="ui-sortable-handle">
                            <td colspan="3">${jsLang("Location not found! Please create location for this vendor.")}</td>
                        </tr>`;$(".variation_stock_data").each(function(){$(this).append(b)})}$("#location_tab").html(b)},complete:function(){$("#temp_vendor_id").val(a),resetSelect2Fields()}})}function getRawVariationLocation(a,b){let c=123456,d="var_"+c++,e=``;return $.each(a,function(a,c){e+=`
                      <tr draggable="false"
                        class="ui-sortable-handle variation_stock">
                        <td class="label">
                            <div class="d-flex align-items-center rtl:gap-2">
                                <svg class="me-2" width="16" height="11" viewBox="0 0 16 11"
                                     fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="16" height="1" fill="#898989">
                                    </rect>
                                    <rect y="5" width="16" height="1" fill="#898989">
                                    </rect>
                                    <rect y="10" width="16" height="1" fill="#898989">
                                    </rect>
                                </svg>
                                <label class="control-label">${c.name}</label>
                                <input type="hidden" name="location[${b}][${c.id}][id]" value="${c.id}">
                            </div>
                        </td>
                        <td>
                            <input type="number" placeholder="0" class="form-control inputFieldDesign" maxlength="8" name="location[${b}][${c.id}][qty]" value="">
                        </td>
                    </tr>
                    `}),e}function stockResponse(a){let b=``;b=getAdjustStockHtml(a.records.stocks),""==a.records.rowId?$("#location_tab").html(b):$("#adjust_stock_div_"+a.records.rowId).replaceWith(b),$("#save_stock_div").addClass("display_none"),$("#stock_msg").text(jsLang("Vendor stock will show here for each location.")),unblockEverything(),resetSelect2Fields()}function getAdjustStockHtml(a){let b=``,c=Math.floor(100*Math.random()+1);return $.each(a,function(a,d){let e="col_"+c++;b+=`
       <div class="location-dlt ui-sortable-handle" data-serial="${a}" id="adjust_stock_div_${a}">
                <div class="d-flex justify-content-between align-items-center border-t h-40p mx-25n px-32p bg-F5 col-attr collapse-header"
                     data-bs-toggle="collapse" href="#${e="col_"+c++}">
                    <p class="label-title m-0 ml-16n-res font-weight-600 attribute-box-title">${d.location.name}</p>
                    <div class="d-flex align-items-center">
                        <svg class="cursor-move mt-0" width="16" height="11" viewBox="0 0 16 11" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <rect width="16" height="1" fill="#898989" />
                            <rect y="5" width="16" height="1" fill="#898989" />
                            <rect y="10" width="16" height="1" fill="#898989" />
                        </svg>
                        <span
                            class="toggle-btn ml-10p mt-0 d-flex h-20 w-20 align-items-center justify-content-center inactive-sec collapsed"
                            data-bs-toggle="collapse" href="#${e}">
                            <svg width="8" height="6" viewBox="0 0 8 6" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M4.18767 5.90789L7.81732 1.34361C8.24162 0.810056 7.87956 -1.43628e-09 7.21678 -9.33983e-09L0.783223 -8.60592e-08C0.120445 -9.39628e-08 -0.241618 0.810055 0.182683 1.34361L3.81233 5.90789C3.91 6.0307 4.09 6.0307 4.18767 5.90789Z"
                                    fill="#2C2C2C" />
                            </svg>
                        </span>
                        
                    </div>
                </div>
                <div class="collapse" id="${e}">
                    <div class="row m-0 px-7 pb-30p">
                                              
                        <input type="hidden" name="product_id" value="${d.product_id}">
                        <input type="hidden" name="location_id" value="${d.location_id}">
                        <input type="hidden" name="row_id" value="${a}">

                        <div class="form-group row">
                            <label class="col-sm-6 control-label" for="inputEmail3">${jsLang("Available")}</label>

                            <label class="col-sm-6 control-label" for="inputEmail3" id="available_stock_${e}">${parseInt(d.available)}</label>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-6 control-label require" for="inputEmail3">${jsLang("Adjust By")}</label>

                            <div class="col-sm-6">
                                <input type="number" placeholder="${jsLang("Adjust By")}" value="0" class="form-control adjust_by inputFieldDesign adjust_by" name="adjust_by" id="adjust_by_${e}" data-rowId="${e}" required oninvalid="this.setCustomValidity('${jsLang("This field is required.")}')">
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-6 control-label require" for="inputEmail3">${jsLang("New")}</label>

                            <div class="col-sm-6">
                                <input type="number" placeholder="${jsLang("New")}" value="${parseInt(d.available)}" class="form-control new inputFieldDesign new_stock" name="new" id="new_stock_${e}" data-rowId="${e}" required oninvalid="this.setCustomValidity('${jsLang("This field is required.")}')">
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-6 control-label require pr-0 "
                                   for="inputEmail3">${jsLang("Reason")}</label>
                            <div class="col-sm-6">
                                <select class="form-control select2 sl_common_bx" name="reason" required oninvalid="this.setCustomValidity('${jsLang("This field is required.")}')">
                                    <option value="Correction">${jsLang("Correction")}</option>
                                    <option value="Count">${jsLang("Count")}</option>
                                    <option value="Received">${jsLang("Received")}</option>
                                    <option value="Return_restock">${jsLang("Return restock")}</option>
                                    <option value="Damaged">${jsLang("Damaged")}</option>
                                    <option value="Theft_or_loss">${jsLang("Theft or loss")}</option>
                                    <option value="Promotion_or_donation">${jsLang("Promotion or donation")}</option>
                                </select>
                            </div>
                        </div>
    
                        <div class="mt-25p mx-7p px-6 border-t mx-25n px-32p">
                            <a href="javascript:void(0)" class="w-175p btn-confirms mt-24p update_adjust" data-rowId="${a}">${jsLang("Update")}</a>
                        </div>
                      
                    </div>
                </div>
            </div>
     `}),b}const unblockEverything=()=>{$(".blockUI").each(function(){$(this).parent().unblock()})},resetSelect2Fields=()=>{$("select.select2").select2({allowClear:!1,placeholder:jsLang("Select an option")}),$("select.select2clearable").select2({allowClear:!0,placeholder:jsLang("Select an option")})};$(document).on("blur change",".adjust_by",function(){""==$(this).val()&&($(this).val(0),$(this).trigger("change")),$(this).val(parseInt($(this).val()));let a=$(this).attr("data-rowId"),b=parseInt($("#available_stock_"+a).text());$("#new_stock_"+a).val(parseInt(b)+parseInt($(this).val()))}),$(document).on("blur change",".new_stock",function(){""==$(this).val()&&($(this).val(0),$(this).trigger("change")),$(this).val(parseInt($(this).val()));let a=$(this).attr("data-rowId"),b=parseInt($("#available_stock_"+a).text());$("#adjust_by_"+a).val(parseInt($(this).val())-parseInt(b))});const triggerNotification=a=>{$(".notification-msg-bar").find(".notification-msg").html(a),$(".notification-msg-bar").removeClass("smoothly-hide"),setTimeout(()=>{$(".notification-msg-bar").addClass("smoothly-hide"),$(".notification-msg-bar").find(".notification-msg").html("")},2500)};
