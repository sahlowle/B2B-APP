'use strict';$(function(){function a(a){var b=$("#"+a).attr("data-id");$("#theme-title").html(b)}function b(){const a=$("input[name=\"activation_date\"]"),b=$("input[name=\"next_billing_date\"]"),c=moment(a.val(),dateFormatForMoment),d=moment(b.val(),dateFormatForMoment);if(c.isAfter(d)){const b=d.clone().subtract(m[$("#billing_cycle").val()],"days");a.val(b.format(dateFormatForMoment)),a.data("daterangepicker").setStartDate(b),a.data("daterangepicker").setEndDate(b)}}function c(a){var b=$.Deferred();return $.ajax({url:SITE_URL+"/package/get-info/"+a,type:"get",success:function(a){b.resolve(a)}}),b.promise()}function d(a){a&&$("#renewable").val(a.renewable)}function e(a){if(a){var b=$("#billing_cycle").val(),c=0<a.discount_price[b]?a.discount_price[b]:a.sale_price[b];$("#billing_price, #amount_billed").val(c),"Paid"==$("#payment_status").val()?($("#amount_received").val(c),$("#amount_due").val(0)):($("#amount_due").val(c),$("#amount_received").val(0)),"days"==b?($("#duration_days").removeClass("d-none"),$("#duration").val(a.duration).attr("readonly",!0)):($("#duration_days").addClass("d-none"),$("#duration").val("").attr("readonly",!0))}}function f(a){var b=1,c=$("#billing_cycle").val();b="days"==c?a.duration:m[c],($("#subscription-add-container").length||$("#subscription-edit-container").length)&&$("input[name=\"next_billing_date\"]").daterangepicker({singleDatePicker:!0,showDropdowns:!0,startDate:moment().add(b,"day"),minDate:moment().add(1,"day"),locale:{format:"YYYY-MM-DD"}})}function g(a,b=null){for(const c in $("#billing_cycle").html(""),a.billing_cycle)1==a.billing_cycle[c]&&$("#billing_cycle").append(`
                    <option ${b==c?"selected":""}  value="${c}">${c.charAt(0).toUpperCase()+c.slice(1)}</option>
                `);$(".select2-hide-search").select2({minimumResultsForSearch:1/0})}function h(a){for(const d in a)if("value"==a[d].key){$("input[name=\"meta["+a[d].feature+"][value]\"]").val(a[d].value),$("select[name=\"meta["+a[d].feature+"][value]\"]").val(a[d].value).trigger("change");const e=$("select[name=\"meta["+a[d].feature+"][value][]\"]");if(e.length){e.find("option").prop("selected",!1);for(var b=JSON.parse(a[d].value.replace(/'/g,"\"")),c=0;c<b.length;c++)e.find("option[value=\""+b[c]+"\"]").prop("selected",!0)}}}function i(a,b=!0){var c=$(a).closest(".billing-parent").find("input[type=\"text\"]");c.attr("readonly",b),b&&c.val(null)}function j(a){const b=new Date(a),c=new Date;return b.getFullYear()===c.getFullYear()&&b.getMonth()===c.getMonth()&&b.getDate()===c.getDate()}var k=["v-pills-general-tab","v-pills-optional-tab","v-pills-optionals-tab"];if("undefined"!=typeof dynamic_page){k=["v-pills-general-tab"];for(const a of dynamic_page)k.push(`v-pills-${a}-tab`)}$(document).on("click",".tab-name",function(){var a=$(this).attr("data-id");$("#theme-title").html(a)}),$(document).on("click","button.switch-tab",function(){$("#"+$(this).attr("data-id")).tab("show");var b=$(this).attr("data-id");a(b),$(".tab-pane[aria-labelledby=\"home-tab\"").addClass("show active"),$("#"+$(this).attr("id")).addClass("active").attr("aria-selected",!0)});var l=setInterval(()=>{$("#btnGroupDrop1").length&&($("#btnGroupDrop1").css("display","none"),$(".btn-group").css({display:"inline-block"}),$("#dataTableBuilder_length").css({"margin-top":"-20px"}),clearInterval(l))},100);$(document).on("keyup",".int-number",function(){let a=$(this).val();$(this).val(a.replace(/[^0-9-]/g,""))}),$(".package-submit-button, .package-feature-submit-button, .credit-submit-button").on("click",function(){setTimeout(()=>{for(const c of k)if($("#"+c.replace("-tab","")).find(".error").length){var b=$("#"+c.replace("-tab","")).attr("aria-labelledby");$("#"+b).tab("show"),a(b);break}},100)}),$(".add-feature-nav").on("click",function(){var a=$(this).attr("data-count"),b=$("#add-feature-nav").find("li a");b.attr("id",`v-pills-${a}-tab`).attr("href",`#v-pills-${a}`).attr("aria-controls",`v-pills-${a}`).attr("data-id",jsLang("Custom")+a),b.text(jsLang("Custom")+a),$(this).attr("data-count",+a+1),$(this).before($("#add-feature-nav").html());var c=$("#add-feature-data");c.find(".tab-pane").attr("id",`v-pills-${a}`).attr("aria-labelledby",`v-pills-${a}-tab`),c.find(".type").attr("name",`meta[custom${a}][type]`),c.find(".title").attr("name",`meta[custom${a}][title]`),c.find(".description").attr("name",`meta[custom${a}][description]`),c.find(".is_visible").attr("name",`meta[custom${a}][is_visible]`).addClass("select2-dynamic"),c.find(".status").attr("name",`meta[custom${a}][status]`).addClass("select2-dynamic"),$("#topNav-v-pills-tabContent").append(c.html()),$("#add-feature-data").find(".is_visible, .status").removeClass("select2-dynamic"),$(".select2-dynamic").select2({minimumResultsForSearch:1/0})}),$(document).on("click",".custom-feature-nav .close",function(){$("#v-pills-general-tab").tab("show"),a("v-pills-general-tab");var b=$(this).siblings("a").attr("aria-controls");$(this).closest(".custom-feature-nav").remove(),$("#"+b).remove()}),$("#subscription-add-container").length&&($("input[name=\"activation_date\"]").daterangepicker(dateSingleConfig()),$("input[name=\"billing_date\"]").daterangepicker(dateSingleConfig()),$("input[name=\"next_billing_date\"]").daterangepicker(dateSingleConfig())),$("#subscription-edit-container").length&&($("input[name=\"activation_date\"]").daterangepicker(dateSingleConfig($("input[name=\"activation_date\"]").val())),$("input[name=\"billing_date\"]").daterangepicker(dateSingleConfig($("input[name=\"billing_date\"]").val())),$("input[name=\"next_billing_date\"]").daterangepicker(dateSingleConfig($("next_input[name=\"billing_date\"]").val()))),$("input[name=\"activation_date\"]").on("change",function(){b()}),$("input[name=\"next_billing_date\"]").on("change",function(){b()}),$("input[name=\"billing_date\"], input[name=\"activation_date\"], input[name=\"next_billing_date\"]").on("change",function(){var a=$("input[name=\"activation_date\"]").val(),b=$("input[name=\"billing_date\"]").val(),c=$("input[name=\"next_billing_date\"]").val();(moment(a).isAfter(b)||!moment(c).isAfter(b))&&($("input[name=\"billing_date\"]").val(a),$("input[name=\"billing_date\"]").data("daterangepicker").setStartDate(a),$("input[name=\"billing_date\"]").data("daterangepicker").setEndDate(a))}),$("#billing_cycle").on("change",function(){var a=$(this).val();"days"==a?$("#duration_days").removeClass("d-none"):$("#duration_days").addClass("d-none")}),$(document).on("click","#email_invoice",function(a){a.preventDefault(),parent=this,$(this).attr("disabled",!0).find(".feather").addClass("icon-loader"),$.ajax({url:$(parent).attr("url"),type:"get",success:function(a){$(".top-notification").removeClass("d-none").find(".alert").addClass("alert-success").removeClass("alert-danger").find(".alertText").text(a.message)},complete:function(){$(parent).removeAttr("disabled").find(".feather").removeClass("icon-loader")}})});const m={lifetime:0,yearly:365,monthly:30,weekly:7};if($(".select2#package_id").on("select2:select",function(a){var b=a.params.data.id,i=c(b);i.done(function(a){h(a.metadata),d(a),g(a),e(a),f(a)})}),$("#subscription-edit-container").length){var n=c($(".select2#package_id").val());n.done(function(a){var b=$("#billing_cycle").val();g(a,b)})}if($("#subscription-add-container").length){var n=c($(".select2#package_id").val());n.done(function(a){d(a),g(a),e(a),f(a)})}$(".select2-hide-search#billing_cycle").on("select2:select",function(){var a=$(this).val();"days"==a?$("#duration_days").removeClass("d-none"):$("#duration_days").addClass("d-none");var b=c($(".select2#package_id").val());b.done(function(a){d(a),e(a),f(a)})}),$(".select2-hide-search#payment_status").on("select2:select",function(a){var b=a.params.data.text,c=$("#billing_price").val();"Paid"==b?($("#amount_received").val(c),$("#amount_due").val(0)):($("#amount_received").val(0),$("#amount_due").val(c))}),$(".billing-checkbox").on("change",function(){$(this).is(":checked")?i(this,!1):i(this,!0)}),$("input[name=\"check_billing\"]").on("change",function(){var a=$(this).val();$(".plan-parent").addClass("d-none"),0==$(`.plan-${a}`).length?$(".plan-root").append(`
                <div class="plan-parent plan-${a}">
                    <p class="text-color-14 dark:text-white mx-auto text-[22px] leading-6 font-semibold px-5 break-words text-center">${jsLang("No plan available under this category")}</p>
                </div>
            `):$(`.plan-${a}`).removeClass("d-none")}),$("#user_list").on("change",function(){$("#user_email").val($(this).val())}),$(document).on("click",".link-modal",function(){$("#generate_link_btn").attr("data-id",$(this).attr("id"))}),$("#generate_link_btn").on("click",function(){const a=$(this).attr("data-id"),b=$("#user_email").val();$.ajax({url:generateLinkUrl,type:"post",data:{_token:token,plan_id:a,email:b},success:function(a){$("#all_links").removeClass("d-none"),$("#all_links").find("tbody").prepend(`
                    <tr>
                        <td>${a.data.link.substr(a.data.link.length-40)}</td>
                        <td><button title="${a.data.email}" class="copy-link-btn" data-link="${a.data.link}">${jsLang("Copy Link")}</button></td>
                    </tr>
                `)}})}),$("#get_generate_link_btn").on("click",function(){var a=$(this).attr("data-id");$.ajax({url:ADMIN_SITE_URL+"/package/generate-link/"+a,type:"get",success:function(a){for(const b in $("#all_links").removeClass("d-none"),$("#all_links").find("tbody").empty(),a.data)$("#all_links").find("tbody").append(`
                        <tr>
                            <td>${a.data[b].link.substr(a.data[b].link.length-40)}</td>
                            <td><button title="${a.data[b].email}" class="copy-link-btn" data-link="${a.data[b].link}">${jsLang("Copy Link")}</button></td>
                        </tr>
                    `);$("#get_generate_link_btn").remove()}})}),$(document).on("click",".copy-link-btn",function(){var a=$(this).attr("data-link"),b=$(this).html();navigator.clipboard.writeText(a),$(this).html("<i class=\"feather icon-check\"></i>"),setTimeout(()=>{$(this).html(b)},2e3)}),$(document).on("keyup","#subscription_remaining_days, #subscription_expire_days",function(){let a=$(this).val();","==a[0]&&(a=a.slice(a[1],a)),a=a.replace(/[^0-9-,]/g,"");const b=a.split(",");var c=b.map(function(a){return 365<+a?365:a});$(this).val(c.toString())}),$(document).on("click",".mail-modal",function(){var a=JSON.parse($(this).attr("data-schedule-dates")),b=JSON.parse($(this).attr("data-schedule-db-dates")),c=$(this).attr("data-mail-type"),d=$(this).attr("data-last-sent-mail");$("#last_sent_mail").text(d),$("#mail_type").text(c),$("#mail_type_input").val(c),$("#subscription_id").val($(this).attr("id"));var e="",f=!1;for(const b of a)e+=`<p>${b}</p>`;for(const a of b)!f&&j(a)&&(f=!0);$("#schedule_dates").html(e);var g="disabled";$("#manual_mail_submit").removeClass("conditionally-enabled"),$("#immediate_mail").attr("disabled",!1),f&&(g=!1,$("#manual_mail_submit").addClass("conditionally-enabled"),$("#immediate_mail").attr("disabled","disabled")),$("#manual_mail_submit").attr("disabled",g)}),$(document).on("change","#immediate_mail",function(){this.checked?$("#manual_mail_submit").attr("disabled",!1):!$("#manual_mail_submit").hasClass("conditionally-enabled")&&$("#manual_mail_submit").attr("disabled","disabled")});let o;$(document).on("input",".package-limit",function(){const a=$(this);clearTimeout(o),o=setTimeout(()=>{let b=a.val().trim();if("-"===b)return void a.val(-1);let c=+b;(isNaN(c)||-1>c)&&a.val(-1)},1e3)})});
