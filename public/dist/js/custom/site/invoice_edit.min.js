"use strict";let loader=`<option value="">${jsLang("Loading")}...</option>`,selectCity=`<option value="">${jsLang("Select City")}</option>`,selectState=`<option value="">${jsLang("Select State")}</option>`,errorMsg=jsLang(":x is not available.");var stack=[],rowNo=0;$(".shipping-address-form").find("#ShippingaddressForm").length&&$.ajax({url:SITE_URL+"/geo-locale/countries",type:"GET",dataType:"json",beforeSend:function(){$("#shipping_country").html(loader),$("#shipping_country").attr("disabled","true")},success:function(a){$("#shipping_country").html("<option value=\"\">"+jsLang("Select Country")+"</option>"),$.each(a,function(a,b){$("#shipping_country").append(`'<option  ${b.code==oldShipCountry?"Selected":""} data-country="${b.code}" value="${b.code}">${b.name}</option>'`)}),$("#shipping_country").removeAttr("disabled")}}),"null"!=oldShipState&&getShipState(oldShipCountry),"null"!=oldShipCity&&getShipCity(oldShipState,oldShipCountry),$("#shipping_country").on("change",function(){let a=$(this).find(":selected").html();if(oldShipCountry="null",0<a.length){let a=this.closest(".validSelect");a.querySelector(".addressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove()}getShipState($("#shipping_country").find(":selected").attr("data-country"))});function getShipState(a){a?($("#shipping_state").html(""),"null"==oldShipCity&&$("#shipping_city").html(selectCity),$.ajax({url:SITE_URL+"/geo-locale/countries/"+a+"/states",type:"GET",dataType:"json",beforeSend:function(){$("#shipping_state").attr("disabled","true"),$("#shipping_state").html(loader)},success:function(a){$("#shipping_state").html(selectState),$.each(a.data,function(a,b){$("#shipping_state").append(`'<option ${b.code==oldShipState?"Selected":""} data-state="${b.code}" value="${b.code}">${b.name}</option>'`)}),$("#shipping_state").removeAttr("disabled"),0>=a.length&&0>=a.data.length&&(errorMsg=errorMsg.replace(":x","State"),$("#shipping_state").html(`<option value="">${errorMsg}</option>`))}})):($("#shipping_state").html(selectState),$("#shipping_city").html(selectCity))}$("#shipping_state").on("change",function(){let a=$(this).find(":selected").html();if(0<a.length){let a=this.closest(".validSelect");a.querySelector(".addressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove()}getShipCity($("#shipping_state").find(":selected").attr("data-state"),$("#shipping_country").find(":selected").attr("data-country"))});function getShipCity(a,b){a&&b?($("#shipping_city").html(""),$.ajax({url:SITE_URL+"/geo-locale/countries/"+b+"/states/"+a+"/cities",type:"GET",dataType:"json",beforeSend:function(){$("#shipping_city").html(loader),$("#shipping_city").attr("disabled","true")},success:function(a){$("#shipping_city").html(selectCity),$.each(a.data,function(a,b){$("#shipping_city").append(`<option ${b.name==oldShipCity?"Selected":""} value="${b.name}">${b.name}</option>`)}),$("#shipping_city").removeAttr("disabled"),0>=a.length&&0>=a.data.length&&(errorMsg=errorMsg.replace(":x","City"),$("#shipping_city").html(`<option value="">${errorMsg}</option>`))}})):$("#shipping_city").html(selectCity)}$("#shipping_city").on("change",function(){let a=$(this).find(":selected").html();if(0<a.length){let a=this.closest(".validSelect");a.querySelector(".addressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove()}}),$("#billing_address_edit").on("click",function(){$("#billing_address").hasClass("display_none")?($("#billing_address").removeClass("display_none"),$("#billing_address_edit").html("<i class=\"feather icon-edit-1\"></i>")):($("#billing_address").addClass("display_none"),$("#billing_address_edit").html("<p class=\"text-danger\">Cancel</p>")),$("#billing_address_edit_section").hasClass("display_none")?($("#billing_address_edit_section").removeClass("display_none"),$("#load_billing_address").removeClass("display_none")):($("#billing_address_edit_section").addClass("display_none"),$("#load_billing_address").addClass("display_none"))}),$("#shipping_address_edit").on("click",function(){$("#shipping_address").hasClass("display_none")?($("#shipping_address").removeClass("display_none"),$("#shipping_address_edit").html("<i class=\"feather icon-edit-1\"></i>")):($("#shipping_address").addClass("display_none"),$("#shipping_address_edit").html("<p class=\"text-danger\">Cancel</p>")),$("#shipping_address_edit_section").hasClass("display_none")?($("#copy_billing_address").removeClass("display_none"),$("#shipping_address_edit_section").removeClass("display_none")):($("#shipping_address_edit_section").addClass("display_none"),$("#copy_billing_address").addClass("display_none"))}),$("#copy_billing_address").on("click",function(){$("#shipping_address_first_name").val($("#first_name").val()),$("#shipping_address_last_name").val($("#last_name").val()),$("#shipping_address_phone").val($("#phone").val()),$("#shipping_address_email").val($("#email").val()),$("#shipping_address_company_name").val($("#company_name").val()),$("#shipping_address_address_1").val($("#address_1").val()),$("#shipping_address_address_2").val($("#address_2").val()),$("#shipping_country").val($("#country").val()).trigger("change"),setTimeout(()=>{$("#shipping_state").val($("#state").val()).trigger("change"),setTimeout(()=>{$("#shipping_city").val($("#city").val()).trigger("change")},1e3)},1e3),$("#shipping_address_zip").val($("#zip").val());let a=$("input[name='type_of_place']:checked").val();$("#shipping_radio-w-infill-1").val()==a&&$("#shipping_radio-w-infill-1").prop("checked",!0),$("#shipping_radio-w-infill-2").val()==a&&$("#shipping_radio-w-infill-2").prop("checked",!0)});function isEmptyObject(a){if(null==a)return!1;if("object"!=typeof a)return!1;const b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype)&&isEmpty(a)}function isEmpty(a){for(const b in a)if(Object.hasOwn(a,b))return!1;return!0}$("#load_billing_address").on("click",function(){$.ajax({url:userAddressUrl,type:"POST",data:{_token:token,user_id:$("#user_id").val()},success:function(a){if(!isEmptyObject(a)){$("#first_name").val(a.first_name),$("#last_name").val(a.last_name),$("#phone").val(a.phone),$("#email").val(a.email),$("#company_name").val(a.company_name),$("#address_1").val(a.address_1),$("#address_2").val(a.address_2),$("#country").val(a.country).trigger("change"),setTimeout(()=>{$("#state").val(a.state).trigger("change"),setTimeout(()=>{$("#city").append(`<option value="${a.city}" selected>${a.city}</option>`).trigger("change")},1e3)},1e3),$("#zip").val(a.zip),$("#type_of_place").val(a.type_of_place).trigger("change");let b=a.type_of_place;$("#radio-w-infill-1").val()==b&&$("#radio-w-infill-1").prop("checked",!0),$("#radio-w-infill-2").val()==b&&$("#radio-w-infill-2").prop("checked",!0)}else triggerNotification(jsLang("Address not found."))},error:function(){$(".notification-msg-bar").find(".notification-msg").html(jsLang("Something went wrong, please try again.")),$(".notification-msg-bar").removeClass("smoothly-hide"),setTimeout(()=>{$(".notification-msg-bar").addClass("smoothly-hide"),$(".notification-msg-bar").find(".notification-msg").html("")},1500)}})}),$(document).on("click","#add_item",function(){$("#custom_item_btn").addClass("display_none"),$("#custom_item_list").removeClass("display_none")});function autoCompleteSource(a,b,c){$.ajax({url:c,dataType:"json",type:"POST",data:{_token:token,search:a.term,vendorId:$("#vendor_id").val()},success:function(a){if(1==a.status){var a=a.products;$("#no_div").css("display","none"),b($.map(a,function(a){return{id:a.id,value:a.name}}))}else $(".ui-menu-item").remove(),$("#no_div").css("top",$("#search").position().top+35),$("#no_div").css("left",$("#search").position().left),$("#no_div").css("width",$("#search").width()),$("#no_div").css("display","block")}})}function in_array(a,b){var c;for(c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}$("#search").autocomplete({delay:500,position:{my:"left top",at:"left bottom",collision:"flip"},source:function(a,b){autoCompleteSource(a,b,ADMIN_URL+"/barcode/product-search")},select:function(a,b){var c=b.item;if(c.id){if(!in_array(c.id,stack)){stack[c.id]=c.id;var d=`<tbody id="rowId-${rowNo}" class="purchase_products">
                          <input type="hidden" name="product_id[]" value="${c.id}">
                          <tr class="itemRow rowNo-${rowNo}" id="productId-${c.id}"  data-row-no="${rowNo}">
                              <td class="pl-1">
                              <input type="hidden" name="product_name[]" value="${c.value}">
                                  ${c.value}
                              </td>
                              
                              <td class="productQty">
                                  <input name="product_qty[]" id="product_qty_${rowNo}" class="inputQty form-control text-center positive-float-number" type="text" value="1" data-rowId = ${rowNo}>
                              </td>
                             
                          </tr>
                          
                      </tbody>`;$("#custom-product-table").append(d),checkProductTableData(),rowNo++}return $("#productId-"+c.id).find(".inputQty").trigger("blur"),!1}},minLength:1,autoFocus:!0}).autocomplete("instance")._renderItem=function(a,b){return in_array(b.id,stack)?$("<li style='pointer-events:none;opacity:0.6;'>").append("<div>"+b.value+"</div>").appendTo(a):$("<li>").append("<div>"+b.value+"</div>").appendTo(a)};function checkProductTableData(){0==$(".productQty").length?$("#custom-product-table").addClass("display_none"):$("#custom-product-table").removeClass("display_none")}$(document).on("click","#add_product",function(){$(".purchase_products").remove(),checkProductTableData()}),$(document).on("click",".delete_product",function(){let a=$(this).attr("data-productId");$("#delete_id").val(a),$("#action_type").val("product")}),$(document).on("click",".edit_product",function(){$(this).addClass("display_none"),$("#custom_item_btn").addClass("display_none"),$("#custom_item_list").removeClass("display_none");let a=$(this).attr("data-productId"),b=$(this).attr("data-price"),c=$(this).attr("data-qty"),d=$(this).attr("data-tax");$("#product_price_"+a).addClass("display_none"),$("#product_qty_"+a).addClass("display_none"),$("#product_tax_"+a).addClass("display_none"),$("#product_price_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-2 cancel-able col-md-4 positive-float-number" name="product_price[${a}]" id="product_price_txt_${a}" value="${b}">`),$("#product_qty_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-2 cancel-able col-md-4 positive-float-number" name="product_qty[${a}]" id="product_qty_txt_${a}" value="${c}">`),$("#product_tax_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-2 cancel-able col-md-4 positive-float-number" name="product_tax[${a}]" id="product_qty_txt_${a}" value="${d}">`),$.each($(".custom_tax_"+a),function(){$(this).addClass("display_none");let b=$(this).parent().attr("data-key"),c=$(this).parent().attr("data-amount");$(this).parent().append(`<input type="text" class="form-control inputFieldDesign mt-2 cancel-able col-md-4 positive-float-number" name="custom_tax[${a}][${b}]" value="${c}">`)})}),$(document).on("click","#cancel_btn",function(){$(".cancel-able").remove(),$(".back_action").removeClass("display_none"),$("#custom_item_btn").removeClass("display_none"),$("#custom_item_list").addClass("display_none")}),$(document).on("click","#save_custom",function(){let a="";a=$("#calculations_div").find("input,select").serialize(),blockElement($("#calculations_div")),$.ajax({url:orderCustomizeUrl,type:"POST",data:{_token:token,order_id:orderId,data:a,action:"edit"},success:function(a){$("#calculations_div").replaceWith(a.viewHtml),triggerNotification(jsLang(a.message))},error:function(){triggerNotification(jsLang("Something went wrong, please try again."))},complete:function(a){200==a.status&&unblockEverything()}})}),$(document).on("click",".edit_fee",function(){$(this).addClass("display_none"),$("#custom_item_btn").addClass("display_none"),$("#custom_item_list").removeClass("display_none");let a=$(this).attr("data-key"),b=$(this).attr("data-amount"),c=$(this).attr("data-tax"),d=$(this).attr("data-lbl");$("#order_fee_"+a).addClass("display_none"),$("#order_fee_lbl_"+a).addClass("display_none"),$("#order_fee_tax_"+a).addClass("display_none"),$("#order_fee_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-0 cancel-able col-md-4 positive-float-number" name="order_fee[${a}]" value="${b}">`),$("#order_fee_tax_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-0 cancel-able col-md-4 positive-float-number" name="order_fee_tax[${a}]" value="${c}">`),$("#order_fee_lbl_td_"+a).append(`<input type="text" class="form-control inputFieldDesign mt-0 cancel-able col-md-4" name="order_fee_lbl[${a}]" value="${d}">`),$.each($(".custom_fee_"+a),function(){$(this).addClass("display_none");let a=$(this).parent().attr("data-key"),b=$(this).parent().attr("data-index"),c=$(this).parent().attr("data-amount");$(this).parent().append(`<input type="text" class="form-control inputFieldDesign mt-0 cancel-able col-md-4 positive-float-number" name="custom_tax_fee[${a}][${b}]" value="${c}">`)})}),$(document).on("click",".delete_fee",function(){let a=$(this).attr("data-key");$("#delete_id").val(a),$("#action_type").val("fee")}),$(document).on("click",".delete_coupon",function(){let a=$(this).attr("data-key");$("#delete_id").val(a),$("#action_type").val("coupon_delete")}),$(document).on("submit","form",function(a){if("refund"!=$(this).attr("data-type")){if(a.preventDefault(),"add_products"==$(this).attr("data-type")&&0==$(".inputQty").length)return triggerNotification(jsLang("Please add product first!")),0;var b=this;blockElement($("#calculations_div")),$.ajax({url:$(b).attr("action"),type:"POST",data:$(b).serialize(),success:function(a){$("#calculations_div").replaceWith(a.viewHtml),triggerNotification(jsLang(a.message)),$(b).trigger("reset")},error:function(){triggerNotification(jsLang("Something went wrong, please try again."))},complete:function(){unblockEverything(),stack=[],$(".modal").modal("hide")}})}}),$(document).on("click",".delete_custom_tax",function(){let a=$(this).attr("data-key");$("#delete_id").val(a),$("#action_type").val("custom_tax")});
