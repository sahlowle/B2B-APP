'use strict';$("#dataTableBuilder_length").addClass("p-0"),$("#dataTableBuilder").removeAttr("style"),$(document).on("click",".filterbtn",function(){$(this).toggleClass("btn-primary active")}),$(document).on("change",".filter",function(){var a="?";$(".group-filter").each(function(){$(this).hasClass("active")&&"All"!==$(this).data("filter-value")&&(a+=$(this).data("filter-key")+"="+$(this).data("filter-value")+"&"),a+=$(this).attr("name")+"="+$(this).val()+"&"}),$(".filter").each(function(){a+=$(this).attr("name")+"="+$(this).val()+"&"}),$(`#dataTableBuilder`).DataTable().ajax.url(a).load()}),$(document).on("click",".group-filter",function(){if($(this).hasClass("active"))return!1;$(this).toggleClass("active").siblings().removeClass("active");var a="?";"All"!==$(this).data("filter-value")&&(a+=$(this).data("filter-key")+"="+$(this).data("filter-value")+"&"),$("#dataTableBuilder").DataTable().ajax.url(a).load(),console.log(a,$(this).data("filter-value"),"All"!==$(this).data("filter-value"))});let debounceTimer;$("#dataTableSearch").on("input",function(){clearTimeout(debounceTimer);let a=$(this).val().trim();a.length>=searchMinLength&&(debounceTimer=setTimeout(()=>{let b=$("#dataTableBuilder").DataTable();b.search(a).draw()},searchDelay))});const characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function generateString(a){let b="";const c=characters.length;for(let d=0;d<a;d++)b+=characters.charAt(Math.floor(Math.random()*c));return b}function headerCheckBox(){$(".need-batch-operation").find("table thead tr").prepend(`
        <th class="batch-header" width="2%">
            <input type="checkbox" id="header_checkbox" class="header-checkbox">
        </th>
    `)}function bodyCheckBox(){let a="",b=0;$(".need-batch-operation").find("table tbody tr").each((c,d)=>{a=generateString(10),b=$(d).find(".confirm-delete").attr("data-id"),$(d).prepend(`
            <td class="batch-body align-middle" width="2%">
                <div class="checkbox checkbox-warning d-block me-0 p-0">
                    <input class="body-checkbox" type="checkbox" id="${a}" value="${b}">
                    <label class="cr" for="${a}"></label>
                </div>
            </td>
        `)})}function tableContent(){return 1>=$(".need-batch-operation").find("table tbody tr td").length?($(".batch-header").remove(),!1):void(0==$(".need-batch-operation").find("table thead tr .batch-header").length?headerCheckBox():needCheckHeader(!1),0==$(".need-batch-operation").find("table tbody tr .batch-body").length?bodyCheckBox():needCheckBody(!1))}function needCheckBody(a=!0){$(".need-batch-operation").find("table tbody tr .batch-body input").prop("checked",a)}function needCheckHeader(a=!0){$(".batch-header input").prop("checked",a)}function checkCount(){return $(".batch-body input:checked").length}function hideBatchDeleteButton(){$(".batch-delete-count").closest("a").addClass("d-none")}function showBatchDeleteButton(){$(".batch-delete-count").closest("a").removeClass("d-none")}function batchOperation(){$(".batch-delete-count").text(checkCount()),checkCount()?showBatchDeleteButton():hideBatchDeleteButton()}$(document).ajaxComplete(function(a,b,c){(""==c.url.split("?")[0]||window.location.href.split("?")[0]==c.url.split("?")[0])&&(tableContent(),hideBatchDeleteButton())}),$(document).on("change",".batch-header input",function(){needCheckBody(this.checked),batchOperation()}),$(document).on("change",".batch-body input",function(){needCheckHeader($(".batch-body").length==checkCount()),batchOperation()}),$(document).on("click",".batch-delete-operation",function(){var a=[];$(this).text(jsLang("Deleting")).append(`<div class="spinner-border spinner-border-sm ml-2"></div>`).addClass("disabled-btn"),$(".batch-body input:checked").each((b,c)=>{"undefined"!=$(c).val()&&a.push($(c).val())}),$.ajax({url:ADMIN_SITE_URL+"/batch/delete",type:"POST",dataType:"json",data:{_token:token,records:a,namespace:$(".need-batch-operation").attr("data-namespace"),column:$(".need-batch-operation").attr("data-column")},success:function(a){"success"==a.status?($(`#dataTableBuilder`).DataTable().ajax.reload(null,!1),$(".top-notification").removeClass("d-none").find(".alert").addClass("alert-success").removeClass("alert-danger").find(".alertText").text(a.message)):$(".top-notification").removeClass("d-none").find(".alert").addClass("alert-danger").removeClass("alert-success").find(".alertText").text(a.message),$(".top-notification").siblings(".noti-alert").remove()},error:function(a,b,c){$(".failed-notification").removeClass("d-none").find(".alertText").text(c)},complete:function(){$(".batch-delete-operation").text(jsLang("Yes, Confirm")).removeClass("disabled-btn").find(".spinner-border").remove(),bootstrap.Modal.getOrCreateInstance(document.getElementById("batchDelete")).hide()}})});function updateDataTableTranslations(){$("#dataTableBuilder_previous").html(jsLang("Previous")),$("#dataTableBuilder_next").html(jsLang("Next")),$(".dataTables_empty").eq(0).html(jsLang("No data available in table")),$("#btnGroupDrop1").html(jsLang("Export"));let a=$("#dataTableBuilder_info").html();if(a){let b=a.match(/[\d\.,]+/g);a=`${jsLang("Showing")} ${b[0]} ${jsLang("to")} ${b[1]} ${jsLang("of")} ${b[2]} ${jsLang("entries")}`,$("#dataTableBuilder_info").html(a)}}$(()=>{$("#dataTableBuilder").on("draw.dt",()=>updateDataTableTranslations())}),$(document).ready(function(){$(".need-ajax-status").length&&setTimeout(()=>{$.ajax({url:ADMIN_SITE_URL+"/data-tables/status/"+$(".need-ajax-status").attr("data-table")+"?vendor_id="+$(".need-ajax-status").attr("data-vendor_id"),type:"GET",dataType:"JSON",success:function(a){const b="status",c=$(".need-ajax-status");let d=!0;c.html(""),Object.entries(a).forEach(([a,e],f,g)=>{const h=$("<span>").addClass(b?"group-filter":"").addClass(d?"active":"").attr("data-filter-key",b).attr("data-filter-value",a).html(`${a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()} <span class="text-muted">(${e})</span>`);c.append(h),f<g.length-1&&c.append(" | "),d=!1})}})},1e3)});
